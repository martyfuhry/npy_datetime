import parsedates as p
import Parser_ts  as dt_parse
import datetime as d

to numpy.testing import *

p.set_callback(dt_parse.DateTimeFromString)

# These tests are for checking frequency conversions
# meant for the asfreq() function

    def test_from_Y(self):
    'Test frequency conversions from Y.'
        date1 = (-1960L, 'Y')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1960L, 'Y')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-969L, 'Y')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-220L, 'Y')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1L, 'Y')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (0L, 'Y')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10L, 'Y')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (40L, 'Y')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (132L, 'Y')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_M(self):
    'Test frequency conversions from M.'
        date1 = (-23520L, 'M')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-23520L, 'M')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11617L, 'M')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-2629L, 'M')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6L, 'M')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2L, 'M')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (131L, 'M')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (487L, 'M')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1591L, 'M')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_W(self):
    'Test frequency conversions from W.'
        date1 = (-102268L, 'W')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-102268L, 'W')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-50508L, 'W')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-11427L, 'W')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-26L, 'W')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (9L, 'W')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (570L, 'W')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2118L, 'W')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (6918L, 'W')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_B(self):
    'Test frequency conversions from B.'
        date1 = (-511339L, 'B')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-511339L, 'B')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-252541L, 'B')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-57135L, 'B')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-132L, 'B')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (41L, 'B')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (2848L, 'B')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (10586L, 'B')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (34588L, 'B')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_D(self):
    'Test frequency conversions from D.'
        date1 = (-715875L, 'D')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-715875L, 'D')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-353557L, 'D')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-79989L, 'D')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-184L, 'D')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (59L, 'D')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (3988L, 'D')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (14822L, 'D')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (48424L, 'D')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_h(self):
    'Test frequency conversions from h.'
        date1 = (-17181000L, 'h')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-17181000L, 'h')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-8485368L, 'h')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1919736L, 'h')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-4416L, 'h')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1416L, 'h')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (95712L, 'h')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (355728L, 'h')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1162176L, 'h')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_m(self):
    'Test frequency conversions from m.'
        date1 = (-1030860000L, 'm')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-1030860000L, 'm')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-509122080L, 'm')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-115184160L, 'm')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-264960L, 'm')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (84960L, 'm')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5742720L, 'm')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (21343680L, 'm')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (69730560L, 'm')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_s(self):
    'Test frequency conversions from s.'
        date1 = (-61851600000L, 's')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000L, 's')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800L, 's')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600L, 's')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600L, 's')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600L, 's')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200L, 's')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800L, 's')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600L, 's')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_ms(self):
    'Test frequency conversions from ms.'
        date1 = (-61851600000000L, 'ms')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000L, 'ms')
        date2 = (-61851600000000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000L, 'ms')
        date2 = (-30547324800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000L, 'ms')
        date2 = (-6911049600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000L, 'ms')
        date2 = (-15897600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000L, 'ms')
        date2 = (5097600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000L, 'ms')
        date2 = (344563200000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000L, 'ms')
        date2 = (1280620800000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000L, 'ms')
        date2 = (4183833600000000L, 'us')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])


    def test_from_us(self):
    'Test frequency conversions from us.'
        date1 = (-61851600000000000L, 'us')
        date2 = (-1960L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-969L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-220L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-1L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (0L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (10L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (40L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (132L, 'Y')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-23520L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-11617L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-2629L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-6L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (2L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (131L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (487L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (1591L, 'M')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-102268L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-50508L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-11427L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-26L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (9L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (570L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (2118L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (6918L, 'W')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-511339L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-252541L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-57135L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-132L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (41L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (2848L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (10586L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (34588L, 'B')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-715875L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-353557L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-79989L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-184L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (59L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (3988L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (14822L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (48424L, 'D')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-17181000L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-8485368L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-1919736L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-4416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (1416L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (95712L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (355728L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (1162176L, 'h')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-1030860000L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-509122080L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-115184160L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-264960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (84960L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (5742720L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (21343680L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (69730560L, 'm')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-61851600000L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-30547324800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-6911049600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-15897600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (5097600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (344563200L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (1280620800L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (4183833600L, 's')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-61851600000000000L, 'us')
        date2 = (-61851600000000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-30547324800000000L, 'us')
        date2 = (-30547324800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-6911049600000000L, 'us')
        date2 = (-6911049600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (-15897600000000L, 'us')
        date2 = (-15897600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (5097600000000L, 'us')
        date2 = (5097600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (344563200000000L, 'us')
        date2 = (344563200000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (1280620800000000L, 'us')
        date2 = (1280620800000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
        date1 = (4183833600000000L, 'us')
        date2 = (4183833600000L, 'ms')
        assert_equal(p.convert_freq(date1[0], date1[1], 'M'), date2[0])
